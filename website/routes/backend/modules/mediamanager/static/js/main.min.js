class Media{#ElmP;#Elm;#Data={};#BtnDelete;#callback=()=>{};constructor({elmP:elmP,obj:obj},callback=(()=>{})){this.#ElmP=elmP,this.#Data={...obj},this.#callback=callback,this.#init()}#init(){this.#buildElm(),this.#ElmP.appendChild(this.#Elm),this.#eventListener()}#buildElm(){this.#Elm=createDOMElement({attributes:{"data-id":this.#Data.id,class:"media_block"}}),this.#Elm.appendChild(createDOMElement({type:"img",attributes:{src:this.#Data.path}})),this.#Elm.appendChild(createDOMElement({type:"p",text:this.#Data.name})),this.#BtnDelete=createDOMElement({type:"button",attributes:{class:"btn_delete"},text:"X"}),this.#Elm.appendChild(this.#BtnDelete)}#eventListener(){this.#BtnDelete.addEventListener("click",(evt=>{this.#callback({action:"delete",id:this.#Data.id})}))}}class MediaManager{#Imgs=[];#FileInput;#btnAddmedia=document.getElementById("btn_addmedia");#Elm=document.getElementById("media_ctn");constructor(){this.#InputFile(),this.#init()}#init(){this.#eventListener(),this.#getMedia()}#InputFile(){this.#FileInput=createDOMElement({type:"input",attributes:{type:"file",accept:"image/*",multiple:"multiple"}})}#getMedia(){fetch("/modules/mediamanager/getmedias").then((response=>response.json())).then((response=>this.#build(response)))}#build(data){data.forEach((obj=>{this.#Imgs.push(new Media({elmP:this.#Elm,obj:obj},(data=>{"delete"==data.action&&this.#removeImage(data.id)})))}))}#removeImage(id){fetch("/modules/mediamanager/removemedia",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:id,name:"Delete MEdia"})}).then((response=>response.json())).then((response=>console.log(response)))}#uploadMedia(files){var _=this;const formData=new FormData;for(const file of files)formData.append("images",file);fetchWithProgress("/modules/mediamanager/addmedia",{method:"POST",body:formData},(percent=>{console.log(percent+"%")})).then((text=>JSON.parse(text))).then((response=>{"success"==response.status?response.images.forEach((obj=>{_.#Imgs.push(new Media({elmP:_.#Elm,obj:obj},(data=>{"delete"==data.action&&_.#removeImage(data.id)})))})):alert(response.message)}))}#eventListener(){this.#btnAddmedia.addEventListener("click",(()=>{this.#FileInput.click()})),this.#FileInput.addEventListener("change",(evt=>{this.#uploadMedia(evt.target.files),this.#FileInput.value=""}))}}document.addEventListener("DOMContentLoaded",(evt=>{new MediaManager}));